<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Classroom Boss Fight — SPA</title>
  <link rel="stylesheet" href="styles/styles.css">
  <meta name="description" content="Lightweight SPA with Firebase Auth (Google + Email) and realtime teacher controls" />
</head>
<body>
  <header class="site-header">
    <div class="brand">Classroom Boss Fight</div>
    <nav aria-label="Main">
      <a href="#/login" id="nav-login" class="nav-link">Login</a>
      <a href="#/app" id="nav-app" class="nav-link">App</a>
      <a href="#/profile" id="nav-profile" class="nav-link">Profile</a>
      <a href="#/teacher" id="nav-teacher" class="nav-link">Teacher Dock</a>
    </nav>
    <div class="sp"></div>
    <div class="header-controls">
      <button type="button" id="btnConfig" class="btn small" title="Configure (G)">⚙️</button>
      <button type="button" id="btnSignOut" class="btn small" style="display:none">Sign Out</button>
    </div>
  </header>

  <main id="root" class="root" role="main" tabindex="0">
    <!-- content rendered by JS -->
  </main>

  <footer class="site-footer">
    <small>Works with GitHub Pages (hash routing) • Mobile teacher controls sync via Firebase Realtime Database</small>
  </footer>

  <!-- App scripts: Firebase init must be loaded before auth/app modules use it. Keep minimal and deferred. -->
  <script type="module" src="js/firebase-init.js" defer></script>
  <script type="module" src="js/auth.js" defer></script>
  <script type="module" src="js/router.js" defer></script>
  <script type="module" src="js/app.js" defer></script>

  <!-- UI fragments: static DOM pieces used by app.js (kept markup-only; logic lives in modules) -->
  <div id="ui-fragments" hidden>
    <!-- Config dialog -->
    <dialog id="cfgDlg">
      <form method="dialog" class="cfg" id="cfgForm">
        <section>
          <h4>Boss Settings</h4>
          <div class="row"><label>Boss Name</label><input type="text" id="cfgBossName" value="Ancient Drake"></div>
          <div class="row"><label>Boss Hearts</label><input type="number" id="cfgBossHP" min="1" max="20" value="8"></div>
          <div class="row"><label>Image Pack</label>
            <select id="cfgSubject">
              <option value="math">Math</option>
              <option value="phonics">Phonics</option>
              <option value="story-comprehension">Story Comprehension</option>
            </select>
          </div>
          <div class="row"><label>Background</label>
            <select id="cfgBackground"><option value="__default__">Default</option></select>
          </div>
        </section>
        <section>
          <h4>Guilds & Audio</h4>
          <div id="guildCfg"></div>
          <div class="row"><label>SFX Hit</label><input id="sfxHit" type="file" accept="audio/*"></div>
          <div class="row"><label>SFX Miss</label><input id="sfxMiss" type="file" accept="audio/*"></div>
          <div class="row"><label>SFX Win</label><input id="sfxWin" type="file" accept="audio/*"></div>
        </section>
        <div class="actions">
          <button type="button" class="btn" id="btnSaveCfg">Save</button>
          <button type="button" class="btn" id="btnCancelCfg">Cancel</button>
        </div>
      </form>
    </dialog>

    <!-- Victory banner -->
    <div class="banner" id="victory" hidden>
      <div class="bannerCard">
        <h2 id="victoryTitle">Boss Defeated!</h2>
        <p id="victorySub">Final blow by <b>Guild</b>. Top contributor: <b>Guild</b>.</p>
        <div style="margin-top:14px"><button type="button" class="btn" id="victoryClose">Close</button></div>
      </div>
    </div>

    <!-- Dock and panels -->
    <div id="dock" class="panel" style="display:none">
      <h3>Teacher Dock</h3>
      <div id="dockBtns"></div>
      <div class="gBtnRow">
        <button type="button" class="btn full" id="btnUndo">↶ Undo (U)</button>
        <button type="button" class="btn full" id="btnReset">Reset Fight (R)</button>
        <button type="button" class="btn full" id="btnToggleQ">Toggle Question Chip (Q)</button>
        <button type="button" class="btn full" id="btnToggleTimer">Start/Pause Timer (T)</button>
      </div>
    </div>

    <!-- Guild list / logs used by the app UI -->
    <div id="guildList" style="display:none"></div>
    <div class="panel" id="logPanel" style="display:none">
      <h3>Event Log</h3>
      <div class="log" id="log"></div>
    </div>

    <!-- Status chips -->
    <div style="display:none">
      <span class="pill" id="qChip">Q: <strong id="qNum">1</strong></span>
      <span class="pill" id="timerChip">⏱ <strong id="timerText">00:00</strong></span>
    </div>

    <!-- mute toggle -->
    <input type="checkbox" id="muteToggle" style="display:none" />
  </div>
</body>
</html>
